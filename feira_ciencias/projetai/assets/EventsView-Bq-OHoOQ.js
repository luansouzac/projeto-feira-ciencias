import{_ as H,u as J,m as h,e as v,g as K,c as g,w as s,r as l,o as i,a as o,d as m,b as d,h as _,p as k,t as x,F as Q,i as R}from"./index-zSKt_z7e.js";import{C as W}from"./CrudModal-paS5u5nx.js";import{u as X}from"./eventoStore-BIKWor4j.js";const Y={key:0,class:"text-center py-5"},Z={key:1,class:"text-center py-5 text-red-darken-2"},ee={class:"mt-2"},te={key:2,class:"text-center py-5"},oe={__name:"EventsView",setup(se){const p=J(),a=X(),V={title:h(()=>u.value?"Editar Evento":"Novo Evento"),fields:[{key:"nome",label:"Nome do Evento",type:"text",cols:12,rules:[e=>!!e||"O nome é obrigatório"],defaultValue:""},{key:"data_evento",label:"Data do Evento",type:"date",cols:12,rules:[e=>!!e||"A data é obrigatória"],defaultValue:null},{key:"inicio_submissao",label:"Início da Submissão",type:"datetime-local",cols:12,md:6,rules:[e=>!!e||"O início é obrigatório"],defaultValue:""},{key:"fim_submissao",label:"Fim da Submissão",type:"datetime-local",cols:12,md:6,rules:[e=>!!e||"O fim é obrigatório",(e,t)=>new Date(e)>new Date(t.inicio_submissao)||"Deve ser após o início."],defaultValue:""},{key:"min_pessoas",label:"Mínimo de Pessoas",type:"number",cols:12,md:6,rules:[e=>e>0||"Deve ser maior que zero"],defaultValue:1},{key:"max_pessoas",label:"Máximo de Pessoas",type:"number",cols:12,md:6,rules:[e=>e>0||"Deve ser maior que zero",(e,t)=>e>=t.min_pessoas||"Deve ser maior ou igual ao mínimo."],defaultValue:5},{key:"ativo",label:"Ativo",type:"checkbox",cols:12,defaultValue:1}]},C=async e=>{confirm(`Tem certeza que deseja deletar o evento ${e.nome}?`)&&(await a.deleteEvento(e.id_evento)?p.showSuccess("Evento deletado com sucesso!"):alert("Falha ao deletar evento: "+a.getEventErrors))},r=v("Todos"),c=v(!1),f=v(!1),u=v(null),w=h(()=>r.value==="Todos"||!r.value?a.getAllEventos:a.getAllEventos.filter(e=>e.ativo==r.value)),S=()=>{u.value=null,c.value=!0},A=e=>{u.value={...e},c.value=!0},M=async e=>{f.value=!0;try{e.id_evento?a.updateEvento(e.id_evento,e)?p.showSuccess("Evento alterado com sucesso!"):console.error("Erro ao salvar o evento:",error):a.createEvento(e)?p.showSuccess("Evento criado com sucesso!"):console.error("Erro ao salvar o evento:",error),c.value=!1}catch(t){console.error("Erro ao salvar o evento:",t)}finally{f.value=!1}},N=[{title:"Todos",value:"Todos"},{title:"Ativo",value:"1"},{title:"Inativo",value:"0"}];return K(()=>{a.fetchEventos()}),(e,t)=>{const F=l("v-spacer"),y=l("v-btn"),b=l("v-col"),E=l("v-row"),T=l("v-divider"),z=l("v-select"),D=l("v-progress-circular"),I=l("v-icon"),B=l("v-list-item-title"),O=l("v-chip"),q=l("v-list-item-subtitle"),L=l("v-list-item-content"),$=l("v-list-item"),j=l("v-list"),P=l("v-card-text"),U=l("v-container");return i(),g(U,{fluid:""},{default:s(()=>[o(E,{class:"mb-8"},{default:s(()=>[o(F),t[3]||(t[3]=m()),o(b,{cols:"auto"},{default:s(()=>[o(y,{color:"green-darken-4",class:"mt-6",onClick:S},{default:s(()=>[...t[2]||(t[2]=[m("Novo Evento",-1)])]),_:1})]),_:1})]),_:1}),o(T,{class:"my-6"}),o(E,{align:"center",class:"mb-4"},{default:s(()=>[o(b,{cols:"12",md:"6"},{default:s(()=>[...t[4]||(t[4]=[d("h2",{class:"text-h5 font-weight-bold text-grey-darken-4"},"Eventos",-1),d("p",{class:"text-subtitle-2 text-grey-darken-1"},"Gerencie e acompanhe os eventos cadastrados.",-1)])]),_:1}),o(b,{cols:"12",md:"6",class:"d-flex justify-md-end"},{default:s(()=>[o(z,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=n=>r.value=n),items:N,label:"Filtrar por Ativo",variant:"outlined",density:"compact","hide-details":"",clearable:"",style:{"max-width":"280px"}},null,8,["modelValue"])]),_:1})]),_:1}),o(E,null,{default:s(()=>[o(P,null,{default:s(()=>[k(a).isLoadingEventos?(i(),_("div",Y,[o(D,{indeterminate:"",color:"primary"}),t[5]||(t[5]=d("p",{class:"mt-2"},"Carregando eventos...",-1))])):k(a).getEventoErrors?(i(),_("div",Z,[o(I,{icon:"mdi-alert-circle"}),d("p",ee,"Erro ao carregar eventos: "+x(k(a).getEventoErrors),1)])):w.value.length===0?(i(),_("div",te,[...t[6]||(t[6]=[d("p",null,"Nenhum evento encontrado com os filtros aplicados.",-1)])])):(i(),g(j,{key:3},{default:s(()=>[(i(!0),_(Q,null,R(w.value,n=>(i(),g($,{key:n.id_evento,class:"mb-2 border rounded"},{append:s(()=>[o(y,{icon:"mdi-pencil",variant:"text",size:"small",onClick:G=>A(n)},null,8,["onClick"]),o(y,{icon:"mdi-delete",variant:"text",size:"small",color:"grey",onClick:G=>C(n)},null,8,["onClick"])]),default:s(()=>[o(L,null,{default:s(()=>[o(B,{class:"font-weight-bold"},{default:s(()=>[m(x(n.nome),1)]),_:2},1024),o(q,null,{default:s(()=>[o(O,{color:n.ativo==1?"green":"red",density:"compact"},{default:s(()=>[m(x(n.ativo?"Ativo":"Inativo"),1)]),_:2},1032,["color"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1}),o(W,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=n=>c.value=n),title:V.title,fields:V.fields,item:u.value,loading:f.value,onSave:M},null,8,["modelValue","title","fields","item","loading"])]),_:1})}}},ie=H(oe,[["__scopeId","data-v-93156a6b"]]);export{ie as default};
