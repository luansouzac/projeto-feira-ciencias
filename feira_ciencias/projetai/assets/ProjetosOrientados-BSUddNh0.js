import{_ as W,u as X,e as g,g as Y,l as q,m as Z,c as b,w as e,r as s,f as tt,o as i,a as o,h as _,b as n,d as r,F as A,i as S,t as u,k as et}from"./index-zSKt_z7e.js";const ot={key:0},at={key:2},st={key:1},nt={class:"d-flex justify-space-between align-start"},lt={class:"info-item"},rt={class:"text-body-2"},it=["onClick"],dt={class:"font-weight-bold"},ut={class:"text-caption text-grey-darken-1"},ct={class:"d-none d-sm-table-cell"},mt={class:"d-none d-md-table-cell"},_t={class:"text-right"},vt={__name:"ProjetosOrientados",setup(ft){const z=tt(),j=X(),y=g([]),x=g(!0),c=g(null),k=g(""),w=g("grid");let h=null;const D=sessionStorage.getItem("user_data");D&&(h=JSON.parse(D).user.id_usuario),Y(async()=>{if(x.value=!0,c.value=null,!h){c.value="Não foi possível identificar o usuário. Por favor, faça o login novamente.",j.showError(c.value),x.value=!1;return}try{const l=`/usuarios/${h}/projetos/avaliacao`,{data:t}=await q.get(l);if(!Array.isArray(t)||t.length===0){y.value=[];return}const m=t.map(d=>q.get(`/membros_projeto/${d.id_projeto}`).catch(f=>(console.warn(`Não foi possível buscar membros para o projeto ${d.id_projeto}:`,f),{data:[]}))),v=await Promise.all(m),V=t.map((d,f)=>{const p=v[f].data;return{...d,membros_equipe:Array.isArray(p)?p:[]}});y.value=V.map(I)}catch(l){console.error("Erro ao buscar projetos para avaliação:",l),c.value="Não foi possível carregar seus projetos. Tente novamente mais tarde.",j.showError(c.value)}finally{x.value=!1}});const I=l=>({id:l.id_projeto,titulo:l.titulo,evento:l.eventos?.nome||"Evento não definido",membrosCount:l.membros_equipe?.length??0,status:L(l.id_situacao)}),L=l=>({2:{text:"Ativo",color:"green-darken-2"},3:{text:"Em Avaliação",color:"orange-darken-2"},4:{text:"Concluído",color:"blue-darken-2"},5:{text:"Cancelado",color:"red-darken-2"}})[l]||{text:"Aguardando",color:"grey"},C=Z(()=>k.value?y.value.filter(l=>l.titulo.toLowerCase().includes(k.value.toLowerCase())):y.value),M=l=>{z.push(`/projetos/orientados/${l.id}`)};return(l,t)=>{const m=s("v-col"),v=s("v-row"),V=s("v-text-field"),d=s("v-icon"),f=s("v-tooltip"),p=s("v-btn"),P=s("v-btn-toggle"),N=s("v-card"),F=s("v-skeleton-loader"),$=s("v-alert"),G=s("v-card-title"),B=s("v-chip"),O=s("v-card-subtitle"),R=s("v-card-item"),T=s("v-card-text"),E=s("v-spacer"),U=s("v-divider"),J=s("v-card-actions"),H=s("v-table"),K=s("v-container");return i(),b(K,{fluid:""},{default:e(()=>[o(v,{class:"mb-6",align:"center"},{default:e(()=>[o(m,{cols:"12"},{default:e(()=>[...t[2]||(t[2]=[n("h1",{class:"text-h4 font-weight-bold text-teal-darken-4"}," Meus Projetos Orientados ",-1),n("p",{class:"text-subtitle-1 text-grey-darken-2"}," Gerencie os projetos que você está orientando. ",-1)])]),_:1})]),_:1}),o(N,{class:"mb-8 pa-4",variant:"outlined"},{default:e(()=>[o(v,{align:"center","no-gutters":""},{default:e(()=>[o(m,{cols:"12",md:"8"},{default:e(()=>[o(V,{modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=a=>k.value=a),label:"Buscar por título do projeto...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),o(m,{cols:"12",md:"4",class:"d-flex justify-start justify-md-end mt-4 mt-md-0"},{default:e(()=>[o(P,{modelValue:w.value,"onUpdate:modelValue":t[1]||(t[1]=a=>w.value=a),mandatory:"",density:"compact",variant:"outlined"},{default:e(()=>[o(p,{value:"grid","aria-label":"Visualização em Grade"},{default:e(()=>[o(d,null,{default:e(()=>[...t[3]||(t[3]=[r("mdi-view-grid-outline",-1)])]),_:1}),o(f,{activator:"parent",location:"bottom"},{default:e(()=>[...t[4]||(t[4]=[r("Grade",-1)])]),_:1})]),_:1}),o(p,{value:"list","aria-label":"Visualização em Lista"},{default:e(()=>[o(d,null,{default:e(()=>[...t[5]||(t[5]=[r("mdi-view-list-outline",-1)])]),_:1}),o(f,{activator:"parent",location:"bottom"},{default:e(()=>[...t[6]||(t[6]=[r("Lista",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),x.value?(i(),_("div",ot,[o(v,null,{default:e(()=>[(i(),_(A,null,S(4,a=>o(m,{key:a,cols:"12",md:"6"},{default:e(()=>[o(F,{type:"list-item-two-line"})]),_:2},1024)),64))]),_:1})])):c.value?(i(),b($,{key:1,type:"error",variant:"tonal",border:"start",prominent:""},{default:e(()=>[r(u(c.value),1)]),_:1})):(i(),_("div",at,[C.value.length===0?(i(),b($,{key:0,type:"info",variant:"tonal",border:"start",prominent:""},{default:e(()=>[...t[7]||(t[7]=[r(" Nenhum projeto foi encontrado com os filtros selecionados. ",-1)])]),_:1})):(i(),_("div",st,[w.value==="grid"?(i(),b(v,{key:0},{default:e(()=>[(i(!0),_(A,null,S(C.value,a=>(i(),b(m,{key:a.id,cols:"12",md:"6"},{default:e(()=>[o(N,{class:"d-flex flex-column",height:"100%",hover:"",variant:"outlined",onClick:Q=>M(a),style:{cursor:"pointer"}},{default:e(()=>[o(R,null,{default:e(()=>[n("div",nt,[o(G,{class:"text-wrap me-2 text-teal-darken-3"},{default:e(()=>[r(u(a.titulo),1)]),_:2},1024),o(B,{color:a.status.color,size:"small",label:"",variant:"tonal"},{default:e(()=>[r(u(a.status.text),1)]),_:2},1032,["color"])]),o(O,{class:"mt-1"},{default:e(()=>[r(u(a.evento),1)]),_:2},1024)]),_:2},1024),o(T,null,{default:e(()=>[n("div",lt,[o(d,{start:"",color:"grey-darken-1",size:"small"},{default:e(()=>[...t[8]||(t[8]=[r("mdi-account-group-outline",-1)])]),_:1}),n("span",rt,[n("strong",null,u(a.membrosCount),1),r(" "+u(a.membrosCount===1?"membro na equipe":"membros na equipe"),1)])])]),_:2},1024),o(E),o(U),o(J,{class:"pa-3"},{default:e(()=>[o(E),t[10]||(t[10]=n("span",{class:"text-body-2 text-grey-darken-1 mr-2"},"Ver detalhes e gerenciar",-1)),o(d,{color:"teal-darken-2"},{default:e(()=>[...t[9]||(t[9]=[r("mdi-arrow-right-circle-outline",-1)])]),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})):w.value==="list"?(i(),b(N,{key:1,variant:"outlined"},{default:e(()=>[o(H,{hover:""},{default:e(()=>[t[13]||(t[13]=n("thead",null,[n("tr",null,[n("th",{class:"text-left"},"Projeto"),n("th",{class:"text-left d-none d-sm-table-cell"},"Status"),n("th",{class:"text-left d-none d-md-table-cell"},"Membros"),n("th",{class:"text-right"},"Ações")])],-1)),n("tbody",null,[(i(!0),_(A,null,S(C.value,a=>(i(),_("tr",{key:`list-${a.id}`,onClick:Q=>M(a),style:{cursor:"pointer"}},[n("td",null,[n("div",dt,u(a.titulo),1),n("div",ut,u(a.evento),1)]),n("td",ct,[o(B,{color:a.status.color,size:"small",label:"",variant:"tonal"},{default:e(()=>[r(u(a.status.text),1)]),_:2},1032,["color"])]),n("td",mt,u(a.membrosCount),1),n("td",_t,[o(p,{color:"grey-darken-2",variant:"text"},{default:e(()=>[t[12]||(t[12]=r(" Gerenciar ",-1)),o(d,{end:""},{default:e(()=>[...t[11]||(t[11]=[r("mdi-arrow-right",-1)])]),_:1})]),_:1})])],8,it))),128))])]),_:1})]),_:1})):et("",!0)]))]))]),_:1})}}},bt=W(vt,[["__scopeId","data-v-3c76d225"]]);export{bt as default};
